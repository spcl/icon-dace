! # 1 "ifsrrtm/surrtftr.f90"
! # 1 "<built-in>"
! # 1 "<command-line>"
! # 1 "/users/pmz/gitspace/icon-model/externals/ecrad//"
! # 1 "ifsrrtm/surrtftr.f90"
subroutine surrtftr

!     adapted from eli j. mlawer, atmospheric & environmental research.
!     by jjmorcrette, ecmwf
!
!     jjmorcrette 20110613 flexible number of g-points
!     abozzo 201306 updated to rrtmg v4.85
!
!     ------------------------------------------------------------------

use parkind1  ,only : jpim ,   jprb
use ecradhook   ,only : lhook, dr_hook, jphook

!use parrrtm   ,only : jpband  ,jpg
use yoerrtftr ,only : ngc     ,ngs      ,ngn      ,ngb       ,ngm     , wt
!use yoerad    ,only : nredglw
use yoerrtm   ,only : jpgpt
!use yoerrtm   ,only : jpgpt, &
!                    & ng1 , ng2 , ng3 , ng4 , ng5 , ng6 , ng7 , ng8 ,&
!                    & ng9 , ng10, ng11, ng12, ng13, ng14, ng15, ng16,&
!                    & ngs1, ngs2, ngs3, ngs4, ngs5, ngs6, ngs7, ngs8,&
!                    & ngs9, ngs10,ngs11,ngs12,ngs13,ngs14,ngs15,ngs16
!
!     ------------------------------------------------------------------

implicit none

!integer(kind=jpim) :: kgc(16), kgs(16), kgm(256), kgn(jpgpt), kgb(jpgpt)
!!integer(kind=jpim) :: kgc(jpg), kgs(jpg), kgm(jpg*jpband), kgn(jpgpt), kgb(jpgpt)

integer(kind=jpim) :: igc70(16) , igc140(16) , igc256(16)
integer(kind=jpim) :: igs70(16) , igs140(16) , igs256(16)

integer(kind=jpim) :: igm70(256), igm140(256), igm256(256)

integer(kind=jpim) :: ign70(70) , ign140(140), ign256(256)
integer(kind=jpim) :: igb70(70) , igb140(140), igb256(256)

real(kind=jphook) :: zhook_handle
if (lhook) call dr_hook('surrtftr',0,zhook_handle)

!-------------------------------------------------------------------------------
!-- configuration for eps with 70 g-points

igc70( :) = (/4,  7,  8,  7,  8, 4,  6, 4,  6, 3, 4, 4, 2, 1, 1, 1 /)

igs70(:) = (/  4, 11,  19,  26,  34,  38,  44,  48, &
            & 54, 57,  61,  65,  67,  68,  69,  70 /)
   
igm70(:) = (/&
 & 1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,             &! band 1
 & 1,1,2,2,3,3,4,4,5,5,6,6,7,7,7,7,             &! band 2
 & 1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,             &! band 3
 & 1,1,2,2,3,3,4,4,5,5,6,6,7,7,7,7,             &! band 4
 & 1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,             &! band 5
 & 1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,             &! band 6
 & 1,1,1,1,2,2,3,3,4,4,5,5,6,6,6,6,             &! band 7
 & 1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,             &! band 8
 & 1,1,2,2,3,3,4,4,5,5,5,5,6,6,6,6,             &! band 9
 & 1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,             &! band 10
 & 1,1,2,2,2,2,3,3,3,3,4,4,4,4,4,4,             &! band 11
 & 1,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,             &! band 12
 & 1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,             &! band 13
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 14
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 15
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1/)             ! band 16  

ign70(:) = (/&
 & 4,4,4,4,                                     &! band 1
 & 2,2,2,2,2,2,4,                               &! band 2
 & 2,2,2,2,2,2,2,2,                             &! band 3
 & 2,2,2,2,2,2,4,                               &! band 4
 & 2,2,2,2,2,2,2,2,                             &! band 5
 & 4,4,4,4,                                     &! band 6
 & 4,2,2,2,2,4,                                 &! band 7
 & 4,4,4,4,                                     &! band 8
 & 2,2,2,2,4,4,                                 &! band 9
 & 4,4,8,                                       &! band 10
 & 2,4,4,6,                                     &! band 11
 & 2,2,4,8,                                     &! band 12
 & 6,10,                                        &! band 13
 & 16,                                          &! band 14
 & 16,                                          &! band 15
 & 16/)                                          ! band 16  

igb70(:) = (/&
 & 1,1,1,1,                                      &! band 1
 & 2,2,2,2,2,2,2,                                &! band 2
 & 3,3,3,3,3,3,3,3,                              &! band 3
 & 4,4,4,4,4,4,4,                                &! band 4
 & 5,5,5,5,5,5,5,5,                              &! band 5
 & 6,6,6,6,                                      &! band 6
 & 7,7,7,7,7,7,                                  &! band 7
 & 8,8,8,8,                                      &! band 8
 & 9,9,9,9,9,9,                                  &! band 9
 & 10,10,10,                                     &! band 10
 & 11,11,11,11,                                  &! band 11
 & 12,12,12,12,                                  &! band 12
 & 13,13,                                        &! band 13
 & 14,                                           &! band 14
 & 15,                                           &! band 15
 & 16/)                                           ! band 16  


!------------------------------------------------------------------------------
!-- configuration with 140 g-points

igc140(:) = (/10, 12, 16, 14, 16, 8, 12, 8, 12, 6, 8, 8, 4, 2, 2, 2 /)

igs140(:) = (/  10,  22,  38,  52,  68,  76,  88,  96, &
            & 108, 114, 122, 130, 134, 136, 138, 140 /)  

igm140(:) = (/&
 & 1,2,3,3,4,4,5,5,6,6,7,7,8,8,9,10,            &! band 1
 & 1,2,3,4,5,6,7,8,9,9,10,10,11,11,12,12,       &! band 2
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,      &! band 3
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,14,14,      &! band 4
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,      &! band 5
 & 1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,             &! band 6
 & 1,1,2,2,3,4,5,6,7,8,9,10,11,11,12,12,        &! band 7
 & 1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,             &! band 8
 & 1,2,3,4,5,6,7,8,9,9,10,10,11,11,12,12,       &! band 9
 & 1,1,2,2,3,3,4,4,5,5,5,5,6,6,6,6,             &! band 10
 & 1,2,3,3,4,4,5,5,6,6,7,7,7,8,8,8,             &! band 11
 & 1,2,3,4,5,5,6,6,7,7,7,7,8,8,8,8,             &! band 12
 & 1,1,1,2,2,2,3,3,3,3,4,4,4,4,4,4,             &! band 13
 & 1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,             &! band 14
 & 1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,             &! band 15
 & 1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2/)             ! band 16  

ign140(:) = (/&
 & 1,1,2,2,2,2,2,2,1,1,                         &! band 1
 & 1,1,1,1,1,1,1,1,2,2,2,2,                     &! band 2
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 3
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,3,                 &! band 4
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 5
 & 2,2,2,2,2,2,2,2,                             &! band 6
 & 2,2,1,1,1,1,1,1,1,1,2,2,                     &! band 7
 & 2,2,2,2,2,2,2,2,                             &! band 8
 & 1,1,1,1,1,1,1,1,2,2,2,2,                     &! band 9
 & 2,2,2,2,4,4,                                 &! band 10
 & 1,1,2,2,2,2,3,3,                             &! band 11
 & 1,1,1,1,2,2,4,4,                             &! band 12
 & 3,3,4,6,                                     &! band 13
 & 8,8,                                         &! band 14
 & 8,8,                                         &! band 15
 & 4,12/)                                         ! band 16  

igb140( :) = (/&
 & 1,1,1,1,1,1,1,1,1,1,                         &! band 1
 & 2,2,2,2,2,2,2,2,2,2,2,2,                     &! band 2
 & 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,             &! band 3
 & 4,4,4,4,4,4,4,4,4,4,4,4,4,4,                 &! band 4
 & 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,             &! band 5
 & 6,6,6,6,6,6,6,6,                             &! band 6
 & 7,7,7,7,7,7,7,7,7,7,7,7,                     &! band 7
 & 8,8,8,8,8,8,8,8,                             &! band 8
 & 9,9,9,9,9,9,9,9,9,9,9,9,                     &! band 9
 & 10,10,10,10,10,10,                           &! band 10
 & 11,11,11,11,11,11,11,11,                     &! band 11
 & 12,12,12,12,12,12,12,12,                     &! band 12
 & 13,13,13,13,                                 &! band 13
 & 14,14,                                       &! band 14
 & 15,15,                                       &! band 15
 & 16,16/)                                       ! band 16  



!------------------------------------------------------------------------------
!-- configuration with 256 g-points

igc256(:) = (/16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16 /)

igs256(:) = (/ 16,  32,  48,  64,  80,  96, 112, 128, &
            & 144, 160, 176, 192, 208, 224, 240, 256 /)  

igm256(:) = (/&
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,      &! band 1
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,13,14,14,      &! band 2
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,      &! band 3
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,      &! band 4
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,      &! band 5
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,      &! band 6
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,      &! band 7
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,13,14,14,      &! band 8
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,      &! band 9
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,      &! band 10
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,      &! band 11
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,      &! band 12
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,      &! band 13
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,      &! band 14
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,      &! band 15
 & 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16 /)     ! band 16

ign256(:) = (/&
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 1
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 2
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 3
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 4
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 5
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 6
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 7
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 8
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 9
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 10
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 11
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 12
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 13
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 14
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 15
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 /)            ! band 16

igb256( :) = (/&
 & 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,             &! band 1
 & 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,             &! band 2
 & 3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,             &! band 3
 & 4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,             &! band 4
 & 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,             &! band 5
 & 6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,             &! band 6
 & 7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,             &! band 7
 & 8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,             &! band 8
 & 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,             &! band 9
 & 10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10, &! band 10
 & 11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11, &! band 11
 & 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, &! band 12
 & 13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, &! band 13
 & 14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14, &! band 14
 & 15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15, &! band 15
 & 16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16/) ! band 16  

!-------------------------------------------------------------------------------
!
wt( :) = (/&
 & 0.1527534276_jprb,0.1491729617_jprb,0.1420961469_jprb,0.1316886544_jprb,&
 & 0.1181945205_jprb,0.1019300893_jprb,0.0832767040_jprb,0.0626720116_jprb,&
 & 0.0424925_jprb   ,0.0046269894_jprb,0.0038279891_jprb,0.0030260086_jprb,&
 & 0.0022199750_jprb,0.0014140010_jprb,0.000533_jprb    ,0.000075_jprb    /)  

!-------------------------------------------------------------------------------

if (jpgpt == 70) then

!-- 16
  ngc(:)=igc70(:)
  ngs(:)=igs70(:)

!-- 16*16=256
  ngm(:)=igm70(:)

  ngn(1:70)=ign70(1:70)
  ngb(1:70)=igb70(1:70)

elseif (jpgpt == 140) then
!- 16
  ngc(:)=igc140(:)
  ngs(:)=igs140(:)

!- 16*16=256
  ngm(:)=igm140(:)

  ngn(1:140)=ign140(1:140)
  ngb(1:140)=igb140(1:140)

elseif (jpgpt == 256) then
!- 16
  ngc(:)=igc256(:)
  ngs(:)=igs256(:)

!- 16*16=256
  ngm(:)=igm256(:)

  ngn(1:256)=ign256(1:256)
  ngb(1:256)=igb256(1:256)

endif
   
!     -----------------------------------------------------------------
if (lhook) call dr_hook('surrtftr',1,zhook_handle)
end subroutine surrtftr
! #define __atomic_acquire 2
! #define __char_bit__ 8
! #define __float_word_order__ __order_little_endian__
! #define __order_little_endian__ 1234
! #define __order_pdp_endian__ 3412
! #define __gfc_real_10__ 1
! #define __finite_math_only__ 0
! #define __gnuc_patchlevel__ 0
! #define __gfc_int_2__ 1
! #define __sizeof_int__ 4
! #define __sizeof_pointer__ 8
! #define __gfortran__ 1
! #define __gfc_real_16__ 1
! #define __stdc_hosted__ 0
! #define __no_math_errno__ 1
! #define __sizeof_float__ 4
! #define __pic__ 2
! #define _language_fortran 1
! #define __sizeof_long__ 8
! #define __gfc_int_8__ 1
! #define __dynamic__ 1
! #define __sizeof_short__ 2
! #define __gnuc__ 13
! #define __sizeof_long_double__ 16
! #define __biggest_alignment__ 16
! #define __atomic_relaxed 0
! #define _lp64 1
! #define __ecrad_little_endian 1
! #define __gfc_int_1__ 1
! #define __order_big_endian__ 4321
! #define __byte_order__ __order_little_endian__
! #define __sizeof_size_t__ 8
! #define __pic__ 2
! #define __sizeof_double__ 8
! #define __atomic_consume 1
! #define __gnuc_minor__ 3
! #define __gfc_int_16__ 1
! #define __lp64__ 1
! #define __atomic_seq_cst 5
! #define __sizeof_long_long__ 8
! #define __atomic_acq_rel 4
! #define __atomic_release 3
! #define __version__ "13.3.0"

